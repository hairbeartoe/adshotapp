 {% extends "Navigation.html" %}
 {% block title %}
 {{ date }} - {{ domain }}
 {% endblock %}

 {% block scripts %}
 <!-- Javascript -->
<script type="text/javascript" src="{{ url_for('static', filename='assets/js/bootstrap.js') }}" rel="stylesheet"></script>
<script type="text/javascript" src="{{ url_for('static', filename='assets/js/bootstrap-table.js') }}"></script>

 <!-- ekko lightbox -->
 <script type="text/javascript" src="{{ url_for('static', filename='assets/js/ekko-lightbox.js') }}"></script>
 <script type="text/javascript" src="{{ url_for('static', filename='assets/css/ekko-lightbox.css') }}"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>


<style>
.image-thumbnail {
    object-fit: cover;
    object-position: top;
    height: 150px;
    width: 200px;
}

.modal-content {
    margin-left: 20%;
    max-width: 800px;
    }
</style>
 <script>
     function timeFormat(value, row, index) {
			return moment(row.Capture_Time).format("hh:mm a");
		};
 </script>
 <script>
    $(document).on('click', '[data-toggle="lightbox"]', function(event) {
                    event.preventDefault();
                    $(this).ekkoLightbox({
                        showArrows: false,
                    });
                });
 </script>
 <script>
    window.operateEvents = {
        'click .download': function (e, value, row) {
            window.open('{{url_for("return_file", filepath="")}}'+ encodeURIComponent(row.file) +'&filename='+ encodeURIComponent(row.name));
        },
        'click .add': function (e, value, row) {
            window.open('{{url_for("select_collection", image="")}}'+ encodeURIComponent(row.id), "_self");
        }
    };
    function operateFormatter(value, row, index) {
        return [

            '<div class="col-xs-6 text-center icon-big imagebutton">',
            '<a class="imagebutton download text-center" href="javascript:void(0)" title="Download">',
            '<i class="ti-download"></i><br>Download',
            '</a>',
            '</div>',
            '<div class="col-xs-6 text-center icon-big imagebutton">',
            '<a class="add" href="javascript:void(0)" title="Add">',
            '<i class="ti-plus"></i><br>Add to Collection',
            '</a>',
            '</div>'

        ].join('');
    }
</script>
 {% endblock %}

{% block content %}
<div class="content">
    <div class="container-fluid">
        <h5><a href="{{ url_for('get_sites') }}">SITES</a> > <a href="{{ url_for('get_pages', id=site.id, domain=site.domain) }}"> {{ site.domain.upper() }} </a> > <a href="{{url_for('get_dates', page=page.url, id=page.id)}}" >{{ page.name.upper() }} </a> > {{ date }} </h5>
        <div class="row">
            <div class="col-lg-4 col-md-5 col-lg-offset-4 col-md-offset-3">
                <div class="card">
                    <div class="content text-center">
                        <div class="author">
                          <h3 class="card-title">{{ date }}</h3>
                          <p >{{ domain }}</p>
                        </div>
                    </div>
                    <hr>
                    <div class="text-center">
                        <div class="row">
                            <div class="col-md-12">
                                <h5>{{ image_count }}<br /><small> Images</small></h5>
                            </div>
                        </div>
                        <div class="row">
                            <br>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="row col-lg-10 col-lg-offset-1">
                <div class="fresh-table toolbar-color-azure">
                    <div class="toolbar"></div>
                    <table id="table"
                       data-toggle="table"
                       data-url= {{ url_for('get_images_json', id=page.id, date=date) }}
                       data-side-pagination = "client"
                       data-pagination="true"
                       data-page-list="[5, 10, 15]"
                       data-search="true"
                       data-sortable="true"
                       data-page-size="5"
                       data-query-params=""
                       data-show-toggle="false"
                    data-show-pagination-switch="false"
                    data-pagination-pre-text='previous'
                    data-pagination-next-text='next'
                    >
                        <thead>
                            <tr>
                                <th data-field="image_path" data-halign="center">Image</th>
                                <th data-field="Capture_Time" data-sortable="True" data-formatter="timeFormat">Capture Time</th>
                                <th data-field="Type" data-sortable="true">Type</th>
                                <th data-field="github.name"
                                data-formatter="operateFormatter"
                                data-events="operateEvents" data-halign="center">Actions</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>

    </div>
</div>
{% endblock %}
